import React, { Component} from 'react'
import axios from 'axios'
import { Link } from "react-router-dom";


export default class Single extends Component {
  constructor(props) {
    super(props);
    this.state = {
      userid:props.userId,
      testCaseId: window.location.href.substring(
				window.location.href.lastIndexOf("/") + 1
			),
      scripts:[],
    }
  }


  
  componentDidMount() {
this.loadScripts();
}

  loadScripts(){
    axios
    .get("http://localhost:8080/rest/scripts/byTestCase/" + this.state.testCaseId)
    .then((response) => response.data)
    .then((data) => {
      this.setState({ scripts: data });
      console.log( this.state.scripts);
    });
  }

  render() {
    return (
      <div><h1>TestCase id: {this.state.testCaseId}</h1>
        <h2>Scripts list</h2>
        {renderScripts(
          this.state.scripts
        )}


      </div>
    )
  }
}


function renderScripts(scripts){

  
let scriptValues = Object.values(scripts);
let url = "http://localhost:8080/rest/downloadFiles/";
let scriptList =[];

for (let i = 0; i < scriptValues.length; i++){
  scriptList.push(
    <div key={i} >
					<div>
						<span>Script ID: {scriptValues[i].id}</span>	<br />
            <span>title: {scriptValues[i].name}</span>	<br />
            <a href={url + scriptValues[i].id }> 
            <button>Download</button>
            </a>
            	
					</div> 
          </div>
  )}

return scriptList;
}
